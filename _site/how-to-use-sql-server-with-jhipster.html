<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>How to use SQL Server with jHipster</title>
  <meta name="description" content="Goal: By the end of this tutorial you will have the default JHipster application running on your SQL Server, with everything being functional.">
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:600' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://blog.erick-romero.com/how-to-use-sql-server-with-jhipster">
  <link rel="alternate" type="application/rss+xml" title="My Blog" href="http://blog.erick-romero.com/feed.xml" />
  <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="http://blog.erick-romero.com/">My Blog</a>

    <nav class="site-nav">
        
          
          <a class="page-link" href="http://blog.erick-romero.com/about/">About</a>
          
        
          
        
          
        
          
        
    </nav>

  </div>

</header>


    <div class="page-content">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">How to use SQL Server with jHipster</h1>
    <p class="post-meta">Jun 13, 2015</p>
  </header>

  <article class="post-content">
    <p><em>Goal:</em> By the end of this tutorial you will have the default JHipster application running on your SQL Server, with everything being functional.</p>

<p>Start by running JHipster normally with <code>yo jhipster</code>, select the options to use Java 8, token based authentication, SQL, MySQL as the dev. database, MySQL as the prod. database, Yes with ehcache, No Elasticsearch, No clustered HTTP, No Websockets, Maven, Grunt, and no Compass.</p>

<p>We then add the MS SQL Server JDBC dependency to the project <code>pom.xml</code> file.</p>

<p><em>pom.xml</em></p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="o">&lt;!--</span><span class="x"> </span><span class="n">Microsoft</span><span class="x"> </span><span class="n">JDBC</span><span class="x"> </span><span class="o">--&gt;</span><span class="x">
</span><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">com</span><span class="o">.</span><span class="n">microsoft</span><span class="o">.</span><span class="n">sqlserver</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">sqljdbc41</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="m">4.1</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span><span class="x">
</span><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span><span class="x">
</span><span class="o">&lt;!--</span><span class="x"> </span><span class="n">Liquibase</span><span class="x"> </span><span class="n">MS</span><span class="x"> </span><span class="n">SQL</span><span class="x"> </span><span class="n">Server</span><span class="x"> </span><span class="n">extensions</span><span class="x"> </span><span class="o">--&gt;</span><span class="x">
</span><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">com</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">sabomichal</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">liquibase</span><span class="o">-</span><span class="n">mssql</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="m">1.4</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span><span class="x">
</span><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span></code></pre></figure>

<p>I am using Sql JDBC 4.1, and already have it installed to my personal repository, but if you do not this will not work without some further configuration, check out <a href="https://stackoverflow.com/questions/30207842/add-external-library-jar-to-spring-boot-jar-internal-lib">this</a> stackoverflow question for further reference.</p>

<p>The Liquibase MS SQL Server extension allows you to do some neat stuff we will be using later on in this tutorial.</p>

<h2 id="database-modification">Database modification</h2>

<p>Go into <code>src\main\resources\config\application-dev.yml</code> and change your application to use the new datasource, and your Hibernate configuration to use the SQL Server dialect as seen below:</p>

<p><em>application-dev.yml</em></p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="n">spring</span><span class="o">:</span><span class="x">
    </span><span class="n">profiles</span><span class="o">:</span><span class="x">
        </span><span class="n">active</span><span class="o">:</span><span class="x"> </span><span class="n">dev</span><span class="x">
    </span><span class="n">datasource</span><span class="o">:</span><span class="x">
        </span><span class="n">driverClassName</span><span class="o">:</span><span class="x"> </span><span class="n">com</span><span class="o">.</span><span class="n">microsoft</span><span class="o">.</span><span class="n">sqlserver</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">SQLServerDriver</span><span class="x">
        </span><span class="n">dataSourceClassName</span><span class="o">:</span><span class="x"> </span><span class="n">com</span><span class="o">.</span><span class="n">microsoft</span><span class="o">.</span><span class="n">sqlserver</span><span class="o">.</span><span class="n">jdbc</span><span class="o">.</span><span class="n">SQLServerDataSource</span><span class="x">
        </span><span class="n">url</span><span class="o">:</span><span class="x"> </span><span class="n">jdbc</span><span class="o">:</span><span class="n">sqlserver</span><span class="o">:</span><span class="c">//localhost:1433;databaseName=test</span><span class="x">
        </span><span class="n">databaseName</span><span class="o">:</span><span class="x">
        </span><span class="n">serverName</span><span class="o">:</span><span class="x">
        </span><span class="n">username</span><span class="o">:</span><span class="x"> </span><span class="n">myuser</span><span class="x">
        </span><span class="n">password</span><span class="o">:</span><span class="x"> </span><span class="n">supersecretpassword</span><span class="x">
        </span><span class="n">cachePrepStmts</span><span class="o">:</span><span class="x"> </span><span class="no">true</span><span class="x">
        </span><span class="n">prepStmtCacheSize</span><span class="o">:</span><span class="x"> </span><span class="m">250</span><span class="x">
        </span><span class="n">prepStmtCacheSqlLimit</span><span class="o">:</span><span class="x"> </span><span class="m">2048</span><span class="x">
        </span><span class="n">useServerPrepStmts</span><span class="o">:</span><span class="x"> </span><span class="no">true</span><span class="x">

    </span><span class="n">jpa</span><span class="o">:</span><span class="x">
        </span><span class="n">database</span><span class="o">-</span><span class="n">platform</span><span class="o">:</span><span class="x"> </span><span class="n">org</span><span class="o">.</span><span class="n">hibernate</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">SQLServerDialect</span><span class="x">
        </span><span class="n">database</span><span class="o">:</span><span class="x"> </span><span class="n">SQL_SERVER</span><span class="x">
        </span><span class="n">openInView</span><span class="o">:</span><span class="x"> </span><span class="no">false</span><span class="x">
        </span><span class="n">show_sql</span><span class="o">:</span><span class="x"> </span><span class="no">true</span><span class="x">
        </span><span class="n">generate</span><span class="o">-</span><span class="n">ddl</span><span class="o">:</span><span class="x"> </span><span class="no">false</span><span class="x">
        </span><span class="p">[</span><span class="o">...</span><span class="p">]</span></code></pre></figure>

<p>This assuming your database is called <code>test</code>, change your connection url as necessary.</p>

<p>Now go into <code>*\src\main\resources\config\liquibase\changelog\00000000000000_initial_schema.xml</code> and at the top of the file change the following properties:</p>

<p><em>00000000000000_initial_schema.xml</em></p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="o">&lt;</span><span class="n">databaseChangeLog</span><span class="x">
    </span><span class="n">xmlns</span><span class="o">=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog"</span><span class="x">
    </span><span class="n">xmlns</span><span class="o">:</span><span class="n">ext</span><span class="o">=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog-ext"</span><span class="x">
    </span><span class="n">xmlns</span><span class="o">:</span><span class="n">xsi</span><span class="o">=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="x">
    </span><span class="n">xsi</span><span class="o">:</span><span class="n">schemaLocation</span><span class="o">=</span><span class="s">"http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd"</span><span class="o">&gt;</span><span class="x">

    </span><span class="o">&lt;</span><span class="n">property</span><span class="x"> </span><span class="n">name</span><span class="o">=</span><span class="s">"now"</span><span class="x"> </span><span class="n">value</span><span class="o">=</span><span class="s">"now()"</span><span class="x"> </span><span class="n">dbms</span><span class="o">=</span><span class="s">"mysql,h2"</span><span class="o">/&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">property</span><span class="x"> </span><span class="n">name</span><span class="o">=</span><span class="s">"now"</span><span class="x"> </span><span class="n">value</span><span class="o">=</span><span class="s">"current_timestamp"</span><span class="x"> </span><span class="n">dbms</span><span class="o">=</span><span class="s">"postgresql"</span><span class="o">/&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">property</span><span class="x"> </span><span class="n">name</span><span class="o">=</span><span class="s">"now"</span><span class="x"> </span><span class="n">value</span><span class="o">=</span><span class="s">"GETDATE()"</span><span class="x"> </span><span class="n">dbms</span><span class="o">=</span><span class="s">"mssql"</span><span class="o">/&gt;</span><span class="x">

    </span><span class="o">&lt;</span><span class="n">changeSet</span><span class="x"> </span><span class="n">id</span><span class="o">=</span><span class="s">"00000000000000"</span><span class="x"> </span><span class="n">author</span><span class="o">=</span><span class="s">"jhipster"</span><span class="x"> </span><span class="n">dbms</span><span class="o">=</span><span class="s">"postgresql"</span><span class="o">&gt;</span><span class="x">
        </span><span class="o">&lt;</span><span class="n">createSequence</span><span class="x"> </span><span class="n">sequenceName</span><span class="o">=</span><span class="s">"hibernate_sequence"</span><span class="x"> </span><span class="n">startValue</span><span class="o">=</span><span class="s">"1000"</span><span class="x"> </span><span class="n">incrementBy</span><span class="o">=</span><span class="s">"1"</span><span class="o">/&gt;</span><span class="x">
    </span><span class="o">&lt;/</span><span class="n">changeSet</span><span class="o">&gt;</span><span class="x">
    </span><span class="p">[</span><span class="o">...</span><span class="p">]</span></code></pre></figure>

<p>First, make sure you changed your xml databaseChangeLog property to include the ext. Now inside <code>src\main\resources\config\liquibase\changelog\00000000000000_initial_schema.xml</code> find the data entries and change them:</p>

<p><em>00000000000000_initial_schema.xml</em></p>

<figure class="highlight"><pre><code class="language-go" data-lang="go"><span class="o">&lt;</span><span class="n">ext</span><span class="o">:</span><span class="n">loadData</span><span class="x"> </span><span class="n">encoding</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="x">
            </span><span class="n">file</span><span class="o">=</span><span class="s">"config/liquibase/users.csv"</span><span class="x">
            </span><span class="n">separator</span><span class="o">=</span><span class="s">";"</span><span class="x">
            </span><span class="n">tableName</span><span class="o">=</span><span class="s">"JHI_USER"</span><span class="x"> </span><span class="n">identityInsertEnabled</span><span class="o">=</span><span class="s">"true"</span><span class="o">&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">column</span><span class="x"> </span><span class="n">name</span><span class="o">=</span><span class="s">"activated"</span><span class="x"> </span><span class="k">type</span><span class="o">=</span><span class="s">"boolean"</span><span class="o">/&gt;</span><span class="x">
    </span><span class="o">&lt;</span><span class="n">column</span><span class="x"> </span><span class="n">name</span><span class="o">=</span><span class="s">"created_date"</span><span class="x"> </span><span class="k">type</span><span class="o">=</span><span class="s">"timestamp"</span><span class="o">/&gt;</span><span class="x">
</span><span class="o">&lt;/</span><span class="n">ext</span><span class="o">:</span><span class="n">loadData</span><span class="o">&gt;</span><span class="x">
</span><span class="o">&lt;</span><span class="n">dropDefaultValue</span><span class="x"> </span><span class="n">tableName</span><span class="o">=</span><span class="s">"JHI_USER"</span><span class="x"> </span><span class="n">columnName</span><span class="o">=</span><span class="s">"created_date"</span><span class="x"> </span><span class="n">columnDataType</span><span class="o">=</span><span class="s">"datetime"</span><span class="o">/&gt;</span><span class="x">

</span><span class="o">&lt;</span><span class="n">ext</span><span class="o">:</span><span class="n">loadData</span><span class="x"> </span><span class="n">encoding</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="x">
                </span><span class="n">file</span><span class="o">=</span><span class="s">"config/liquibase/authorities.csv"</span><span class="x">
                </span><span class="n">separator</span><span class="o">=</span><span class="s">";"</span><span class="x">
                </span><span class="n">tableName</span><span class="o">=</span><span class="s">"JHI_AUTHORITY"</span><span class="x">
                </span><span class="n">identityInsertEnabled</span><span class="o">=</span><span class="s">"true"</span><span class="x"> </span><span class="o">/&gt;</span><span class="x">

</span><span class="o">&lt;</span><span class="n">ext</span><span class="o">:</span><span class="n">loadData</span><span class="x"> </span><span class="n">encoding</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="x">
                </span><span class="n">file</span><span class="o">=</span><span class="s">"config/liquibase/users_authorities.csv"</span><span class="x">
                </span><span class="n">separator</span><span class="o">=</span><span class="s">";"</span><span class="x">
                </span><span class="n">tableName</span><span class="o">=</span><span class="s">"JHI_USER_AUTHORITY"</span><span class="x">
                </span><span class="n">identityInsertEnabled</span><span class="o">=</span><span class="s">"true"</span><span class="x"> </span><span class="o">/&gt;</span></code></pre></figure>

<p>Adding the <code>identityInsertEnabled="true"</code> is the same as wrapping your Inserts with <code>IDENTITY_INSERT ON</code> and <code>IDENTITY_INSERT OFF</code> which will allow you to insert the project autogenerated identities directly. This is why we are using the MS SQL Server Liquibase for.</p>

<p>Now try running your application! Everything should be working and you should be on your way to continue using your JHipster application with SQL Server.</p>

<p><em>Originally submitted this to the <a href="https://jhipster.github.io/tips/004_tip_using_ms_sql_server.html">jHipster Tips Section</a></em></p>


  </article>

</div>

    </div>

  </body>

</html>
